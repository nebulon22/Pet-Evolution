<!DOCTYPE html>
<html>
<head>
  <title>Pet Evolusi</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { margin:0; text-align:center; background:#2e7d32; color:white; font-family:sans-serif; overflow-x:hidden; display:flex; flex-direction:column; align-items:center; }
    h2 { margin-top:10px; font-size:6vw; }

    #coinDisplay {
      position: fixed; top:5px; left:5px;
      font-size:4vw; background:rgba(0,0,0,0.3);
      padding:4px 8px; border-radius:6px; z-index:10;
    }

    .pet-wrapper { position:relative; display:flex; align-items:center; justify-content:center; margin-top:20px; gap:20px; }

    .glow {
      position:absolute; width:200px; height:200px;
      background:radial-gradient(circle, rgba(255,255,200,0.8) 0%, transparent 70%);
      animation:glow 2s infinite; border-radius:50%; z-index:0; display:none;
    }
    @keyframes glow { 0%,100%{opacity:0; transform:scale(1);} 50%{opacity:0.8; transform:scale(1.2);} }

    #pet { width:40vw; max-width:220px; height:auto; z-index:1; }

    .sparkle { position:absolute; width:8px; height:8px; background:white; border-radius:50%; opacity:0.8; animation:sparkleMove 1.5s forwards; pointer-events:none; z-index:2; }
    @keyframes sparkleMove { 0%{transform:translateY(0) scale(1);opacity:1;} 100%{transform:translateY(-50px) scale(0.5);opacity:0;} }

    #bubble { position:absolute; left:60%; top:20%; background:white; color:black; padding:8px 12px; border-radius:12px; display:none; max-width:180px; text-align:left; z-index:3; font-size:3.5vw; }
    #bubble::after { content:""; position:absolute; left:-10px; top:20px; border-width:10px; border-style:solid; border-color:transparent white transparent transparent; }

    .thermometer { display:flex; flex-direction:column-reverse; justify-content:flex-start; width:30px; height:200px; border:2px solid #ccc; border-radius:6px; overflow:hidden; }
    .bar { flex:1; margin:1px 0; opacity:0.2; }
    .bar.active { opacity:1; }
    .bar:nth-child(1){background:#800000;} .bar:nth-child(2){background:#b22222;} .bar:nth-child(3){background:#ff4500;}
    .bar:nth-child(4){background:#ff8c00;} .bar:nth-child(5){background:#ffd700;} .bar:nth-child(6){background:#f0e68c;}
    .bar:nth-child(7){background:#adff2f;} .bar:nth-child(8){background:#7fff00;} .bar:nth-child(9){background:#32cd32;}
    .bar:nth-child(10){background:#00ff00;}

    .bar-container { width:80vw; max-width:500px; margin:10px auto; background:#444; border-radius:10px; overflow:hidden; height:24px; }
    #expBar { height:100%; width:0%; text-align:center; color:white; font-size:3.5vw; line-height:24px; background:dodgerblue; transition:width 0.5s ease; }

    button { margin:10px; padding:12px 24px; font-size:4vw; border-radius:10px; }
    button:disabled { opacity:0.5; background:#777 !important; cursor:not-allowed; }

    #resetWrapper { position:fixed; top:5px; right:5px; z-index:10; }
    #resetBtn { font-size:2.5vw; padding:4px 8px; border-radius:6px; opacity:0.6; }
    #resetBtn:hover { opacity:1; }

    @keyframes breathing { 0%,100%{transform:scale(1);} 50%{transform:scale(1.05);} }
    @keyframes hungry-shake { 0%,100%{transform:translateX(0);} 25%{transform:translateX(-10px);} 75%{transform:translateX(10px);} }
    .breathing{animation:breathing 3s infinite;} .hungry{animation:hungry-shake 0.5s infinite;}
  </style>
</head>
<body>
  <h2>üê£ Pet Evolusi</h2>

  <!-- Coin -->
  <div id="coinDisplay">üí∞ 0</div>

  <div class="pet-wrapper" id="petWrapper">
    <!-- Thermometer bar -->
    <div class="thermometer" id="thermometer">
      <div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
      <div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
    </div>

    <!-- Glow effect -->
    <div class="glow" id="evoGlow"></div>

    <!-- Pet -->
    <img id="pet" src="images/egg.png" class="breathing">

    <!-- Bubble -->
    <div id="bubble"></div>
  </div>
  
  <p style="font-size:4vw;">Level Pet: <span id="level">1</span></p>

  <div class="bar-container">
    <div id="expBar">EXP 0%</div>
  </div>

  <button onclick="feedPet()" id="feedBtn">üçñ Feed</button>
  <button id="evoBtn" style="display:none;" onclick="evolvePet()">‚ú® Evo Sekarang!</button>

  <!-- Tombol reset mungil -->
  <div id="resetWrapper">
    <button id="resetBtn" onclick="resetGame()">üîÑ</button>
  </div>

  <!-- Audio -->
  <audio id="soundFeed" src="sounds/feed.mp3" preload="auto"></audio>
  <audio id="soundLevel" src="sounds/levelup.mp3" preload="auto"></audio>
  <audio id="soundEvo" src="sounds/evo.mp3" preload="auto"></audio>

<script>
let pet = JSON.parse(localStorage.getItem("petData")) || { 
  level: 1, exp: 0, stage: "egg", hunger: 30, coins: 0
};

function getPetImage(stage){
  switch(stage){
    case "egg": return "images/egg.png";
    case "chick": return "images/chick.png";
    case "rooster": return "images/rooster.png";
    case "phoenix": return "images/phoenix.png";
    default: return "images/egg.png";
  }
}

function updateUI(){
  document.getElementById("level").textContent = pet.level;
  document.getElementById("pet").src = getPetImage(pet.stage);

  // Thermometer bars
  const bars = document.querySelectorAll("#thermometer .bar");
  const activeBars = Math.round(pet.hunger / 10);
  bars.forEach((bar, i)=>{ i < activeBars ? bar.classList.add("active") : bar.classList.remove("active"); });

  // EXP bar
  const expBar = document.getElementById("expBar");
  expBar.style.width = pet.exp + "%";
  expBar.textContent = "EXP " + pet.exp + "%";

  // Coin display
  document.getElementById("coinDisplay").textContent = "üí∞ " + (pet.coins || 0);

  // Animasi lapar / normal
  const petImg = document.getElementById("pet");
  if(pet.hunger <= 30) { petImg.classList.remove("breathing"); petImg.classList.add("hungry"); }
  else { petImg.classList.remove("hungry"); petImg.classList.add("breathing"); }

  // Lock feed if evo
  const feedBtn = document.getElementById("feedBtn");
  const isEvoLevel = (pet.level===10 && pet.stage==="egg") || (pet.level===20 && pet.stage==="chick") || (pet.level===30 && pet.stage==="rooster");
  feedBtn.disabled = (pet.exp>=100 && isEvoLevel);

  localStorage.setItem("petData", JSON.stringify(pet));
}

function showBubble(text){
  const bubble = document.getElementById("bubble");
  bubble.textContent = text;
  bubble.style.display = "block";
  setTimeout(()=> bubble.style.display="none", 2500);
}

function playSound(id){ 
  const s = document.getElementById(id); 
  if(s){ s.currentTime=0; s.play(); } 
}

function feedPet(){
  pet.hunger = Math.min(100, pet.hunger + 20);
  pet.coins++;

  const isEvoLevel = (pet.level===10 && pet.stage==="egg") || (pet.level===20 && pet.stage==="chick") || (pet.level===30 && pet.stage==="rooster");

  if (pet.exp >= 100) {
    if (isEvoLevel) {
      document.getElementById("evoBtn").style.display="inline-block";
      document.getElementById("evoGlow").style.display="block";
      startSparkle();
      showBubble("EXP penuh ‚Äî tekan Evo Sekarang!");
    } else {
      pet.exp=0; pet.level++;
      playSound("soundLevel");
      showBubble("Level naik! Sekarang level "+pet.level);
    }
    updateUI(); return;
  }

  pet.exp = Math.min(100, pet.exp + 10);

  if (pet.exp >= 100) {
    if (isEvoLevel) {
      document.getElementById("evoBtn").style.display="inline-block";
      document.getElementById("evoGlow").style.display="block";
      startSparkle();
      showBubble("EXP penuh! Tekan Evo Sekarang!");
    } else {
      showBubble("EXP penuh! Tekan Feed sekali lagi untuk naik level.");
    }
  } else {
    showBubble("Nyam nyam üçñ +1 koin!");
    playSound("soundFeed");
  }
  updateUI();
}

function evolvePet(){
  if(pet.level===10 && pet.stage==="egg"){ pet.stage="chick"; pet.coins+=50; showBubble("‚ú® Evolusi jadi Anak Ayam üê• +50 koin!"); }
  else if(pet.level===20 && pet.stage==="chick"){ pet.stage="rooster"; pet.coins+=50; showBubble("‚ú® Evolusi jadi Ayam Jantan üêì +50 koin!"); }
  else if(pet.level===30 && pet.stage==="rooster"){ pet.stage="phoenix"; pet.coins+=50; showBubble("üî• Evolusi jadi Phoenix! +50 koin!"); }

  pet.exp=0;
  document.getElementById("evoBtn").style.display="none";
  document.getElementById("evoGlow").style.display="none";
  document.getElementById("feedBtn").disabled=false;

  playSound("soundEvo");
  updateUI();
}

setInterval(()=>{
  pet.hunger = Math.max(0, pet.hunger - 5);
  if(pet.hunger < 50 && Math.random()<0.3){ showBubble("Aku lapar ü•∫"); }
  updateUI();
},5000);

function resetGame(){
  localStorage.removeItem("petData");
  pet = { level:1, exp:0, stage:"egg", hunger:30, coins:0 };
  updateUI();
  alert("Game direset! Pet kamu lapar ü•∫");
}

function startSparkle(){
  const wrapper=document.getElementById("petWrapper");
  for(let i=0;i<10;i++){
    setTimeout(()=>{
      const spark=document.createElement("span");
      spark.classList.add("sparkle");
      const w=wrapper.clientWidth; const h=wrapper.clientHeight;
      const x=(w/2)+(Math.random()*(w*0.6)-(w*0.3));
      const y=(h/2)+(Math.random()*(h*0.6)-(h*0.3));
      spark.style.left=x+"px"; spark.style.top=y+"px";
      wrapper.appendChild(spark);
      setTimeout(()=>spark.remove(),1500);
    }, i*180);
  }
}
updateUI();
</script>
</body>
</html>
